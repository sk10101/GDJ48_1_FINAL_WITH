<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.with.member.dao.AdminDAO">

	<select id="userList" resultType="member">
		SELECT m.member_id, m.name, u.university_name, m.gender, m.certficate_chk 
		FROM university u, MEMBER m 
		WHERE m.university_idx = u.university_idx;
	</select>

	<select id="userDetail" resultType="member" parameterType="String">
		SELECT m.member_id, m.name, m.gender, u.university_name, m.email, m.phone, m.reg_date, m.member_status, m.hide, m.certficate_chk
		FROM university u, MEMBER m
		WHERE member_id = #{member_id} AND m.university_idx = u.university_idx;
	</select>

	<select id="adminList" resultType="member">
		SELECT member_id, name, phone, gender 
		FROM member WHERE member_class = '관리자회원';
	</select>
	
	<update id="pass" parameterType="String">
		UPDATE member SET certficate_chk = 1 WHERE member_id = #{member_id};
	</update>
	
	<select id="search" resultType="member">
		SELECT member_id, name, phone, gender 
		FROM member WHERE member_class = '관리자회원' AND member_id = #{param1};
	</select>
	
	<select id="usersearch" resultType="member">
		SELECT m.member_id, m.name, u.university_name, m.gender, m.certficate_chk 
		FROM university u, MEMBER m 
		<where>
			<if test="!param2.equals('') and param1 == 'id'">member_id LIKE CONCAT('%', #{param2}, '%') AND m.university_idx = u.university_idx</if>
			<if test="!param2.equals('') and param1 == 'name'">name LIKE CONCAT('%', #{param2}, '%') AND m.university_idx = u.university_idx</if>
			<if test="!param2.equals('') and param1 == 'university'">university_name LIKE CONCAT('%', #{param2}, '%') AND m.university_idx = u.university_idx</if>
			<if test="!param2.equals('') and param1 == 'certficate'">certficate_chk LIKE CONCAT('%', #{param2}, '%') AND m.university_idx = u.university_idx</if>
		</where>
	</select>
	
</mapper>